<!-- status autogenerated section -->

# Cloudflare Encoding Extension

This extension unmarshals Cloudflare Logpush NDJSON payloads into OpenTelemetry logs, using the same transformation logic as the Cloudflare receiver.

| Status                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| -------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Stability                                                                                                                        | [alpha]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Distributions                                                                                                                    | [contrib]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| Issues                                                                                                                           | [![Open issues](https://img.shields.io/github/issues-search/open-telemetry/opentelemetry-collector-contrib?query=is%3Aissue%20is%3Aopen%20label%3Aextension%2Fcloudflareencoding%20&label=open&color=orange&logo=opentelemetry)](https://github.com/open-telemetry/opentelemetry-collector-contrib/issues?q=is%3Aopen+is%3Aissue+label%3Aextension%2Fcloudflareencoding) [![Closed issues](https://img.shields.io/github/issues-search/open-telemetry/opentelemetry-collector-contrib?query=is%3Aissue%20is%3Aclosed%20label%3Aextension%2Fcloudflareencoding%20&label=closed&color=blue&logo=opentelemetry)](https://github.com/open-telemetry/opentelemetry-collector-contrib/issues?q=is%3Aclosed+is%3Aissue+label%3Aextension%2Fcloudflareencoding) |
| [Code Owners](https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/CONTRIBUTING.md#becoming-a-code-owner) | [@Rafael-Rodrigues_crdn](https://www.github.com/Rafael-Rodrigues_crdn)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |

[alpha]: https://github.com/open-telemetry/opentelemetry-collector/blob/main/docs/component-stability.md#alpha
[contrib]: https://github.com/open-telemetry/opentelemetry-collector-releases/tree/main/distributions/otelcol-contrib

<!-- end autogenerated section -->

## Configuration

| Name               | Description                                                                                                                        | Default              |
| ------------------ | ---------------------------------------------------------------------------------------------------------------------------------- | -------------------- |
| `timestamp_field`  | Field in each Cloudflare record to use for log timestamp.                                                                          | `EdgeStartTimestamp` |
| `timestamp_format` | Timestamp format for `timestamp_field`, one of `unix`, `unixnano`, `rfc3339`.                                                      | `rfc3339`            |
| `attributes`       | Optional map of Cloudflare field name to OTel attribute name. If unset, all supported primitive fields are ingested as attributes. | unset                |
| `separator`        | Separator used when flattening nested objects into attributes.                                                                     | `.`                  |

## Behavior

- Expects newline-delimited JSON (NDJSON), one Cloudflare record per line.
- Supports transparent gzip payload detection.
- Groups records by `ZoneName` and sets `cloudflare.zone` resource attribute.
- Derives log severity from `EdgeResponseStatus`.
- Preserves original record as log body map.

## Compatibility with `awss3receiver`

This extension is compatible with `awss3receiver` through its `encodings` setting. Example:

```yaml
extensions:
  cloudflare_encoding:
    timestamp_field: EdgeStartTimestamp
    timestamp_format: rfc3339
    attributes:
      ClientIP: http_request.client_ip

receivers:
  awss3:
    logs:
      s3downloader:
        s3_bucket: my-bucket
      starttime: 2026-02-20T00:00:00Z
      endtime: 2026-02-20T01:00:00Z
      encodings:
        - extension: cloudflare_encoding
          suffix: .cloudflare.ndjson
```
